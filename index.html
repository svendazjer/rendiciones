<!DOCTYPE html> 
<html>
<head>
<meta charset="utf-8">
<title>Aplic. Web de jQuery Mobile</title>
<link href="jquery-mobile/jquery.mobile-1.0.min.css" rel="stylesheet" type="text/css"/>
<script src="jquery-mobile/jquery-1.6.4.min.js" type="text/javascript"></script>
<script src="jquery-mobile/jquery.mobile-1.0.min.js" type="text/javascript"></script>
<script src="cordova.js" type="text/javascript"></script>
<script>
$(document).ready(function() {
	$("#guardar").click(function(e) {
		e.preventDefault();
		// Un mensaje de estado
		$("#resultBlock").html("Obteniendo los datos - esperando...");
		// Hacemos un peticion web y obtenemos la data
		$.post("http://s2.intus.cl/raxteltss2013/test.php", {enviar:$("#guardar").val(), campo: "descripcion", valor: $("#descripcion").val()}, function(data) {
			// Cargamos la data dentro de la etiqueta p
			$("#resultBlock").html(data);
		})
	});
});

var pictureSource;   // picture source
var destinationType; // sets the format of returned value 

// Wait for Cordova to connect with the device
//
document.addEventListener("deviceready",onDeviceReady,false);

// Cordova is ready to be used!
//
function onDeviceReady() {
	pictureSource=navigator.camera.PictureSourceType;
	destinationType=navigator.camera.DestinationType;
}

// Called when a photo is successfully retrieved
//
function onPhotoDataSuccess(imageData) {
	// Uncomment to view the base64 encoded image data
	// console.log(imageData);

	// Get image handle
	//
	var smallImage = document.getElementById('smallImage');

	// Unhide image elements
	//
	smallImage.style.display = 'block';

	// Show the captured photo
	// The inline CSS rules are used to resize the image
	//
	smallImage.src = "data:image/jpeg;base64," + imageData;
}

// Called when a photo is successfully retrieved
//
function onPhotoURISuccess(imageURI) {
	// Uncomment to view the image file URI 
	// console.log(imageURI);

	// Get image handle
	//
	var largeImage = document.getElementById('largeImage');

	// Unhide image elements
	//
	largeImage.style.display = 'block';

	// Show the captured photo
	// The inline CSS rules are used to resize the image
	//
	largeImage.src = imageURI;
}

// A button will call this function
//
function capturePhoto() {
	// Take picture using device camera and retrieve image as base64-encoded string
	navigator.camera.getPicture(onPhotoDataSuccess, onFail, { quality: 50,
		destinationType: destinationType.DATA_URL });
}

// A button will call this function
//
function capturePhotoEdit() {
	// Take picture using device camera, allow edit, and retrieve image as base64-encoded string  
	navigator.camera.getPicture(onPhotoDataSuccess, onFail, { quality: 20, allowEdit: true,
		destinationType: destinationType.DATA_URL });
}

// A button will call this function
//
function getPhoto(source) {
	// Retrieve image file location from specified source
	navigator.camera.getPicture(onPhotoURISuccess, onFail, { quality: 50, 
		destinationType: destinationType.FILE_URI,
		sourceType: source });
}

// Called if something bad happens.
// 
function onFail(message) {
	alert('Failed because: ' + message);
}

</script>
</head> 
<body> 

<div data-role="page" id="page">
	<div data-role="header">
		<h1>Raxtel Rendiciones</h1>
	</div>
	<div data-role="content">	
		<ul data-role="listview">
			<li><a href="#nueva_rendicion">Nueva Rendición</a></li>
		</ul>		
	</div>
	<div data-role="footer">
		<h4>Pie de página</h4>
	</div>
</div>

<div data-role="page" id="nueva_rendicion">
	<div data-role="header">
		<h1>Nueva Rendición</h1>
	</div>
	<div data-role="content">
	  <div data-role="fieldcontain">
	    <label for="fecha">Fecha:</label>
	    <input type="text" name="fecha" id="fecha" value=""/>
	    <label for="descripcion">Descripción:</label>
	    <input type="text" name="descripcion" id="descripcion" value=""/>      
	    <label for="foto">Foto:</label>
	    <input type="file" name="foto" id="foto" />      
      </div>
      <div data-role="fieldcontain">
        <label for="items" class="select">Item:</label>
        <select name="items" id="items">
          <option value="option1">Traslados</option>
          <option value="option2">Combustible</option>
          <option value="option3">Materiales de oficina</option>
          <option value="option3">Consumo</option>
          <option value="option3">Alojamientos</option>
          <option value="option3">Gastos varios</option>
          <option value="option3">Servicios terceros</option>
        </select>
      </div>
    
	  <input type="button" data-role="button" id="foto" value="Boleta/Factura" onclick="capturePhoto();">
      
	  <input type="button" data-role="button" id="guardar" value="Guardar">
    
      <p id="resultBlock"></p>
    </div>
	<div data-role="footer">
		<h4>Pie de página</h4>
	</div>
</div>

<div data-role="page" id="lista_rendiciones">
	<div data-role="header">
		<h1>Lista Rendiciones</h1>
	</div>
	<div data-role="content">	
		Aquí va la lista de rendiciones
	</div>
	<div data-role="footer">
		<h4>Pie de página</h4>
	</div>
</div>

</body>
</html>
